---
import { DashboardScreen } from '@components/app/screens/dashboard'
import { db } from '@db/db'
import { campaign } from '@db/schema'
import MainLayout from '@layouts/main-layout.astro'
import { desc } from 'drizzle-orm'
import { NavBar } from '@/components/app/components/nav-bar/nav-bar'

const campaigns = await db
  .select()
  .from(campaign)
  .orderBy(desc(campaign.updatedAt))
---

<MainLayout
  title='Dashboard | ArcAide'
  seo={{ description: 'Manage your campaigns from one hub, right here!' }}
>
  <NavBar
    transition:persist
    user={Astro.locals.user}
    campaignSlug={undefined}
    client:load
  />
  <DashboardScreen
    campaignSlug={undefined}
    initialCampaigns={campaigns}
    user={Astro.locals.user}
    client:load
  />
</MainLayout>
